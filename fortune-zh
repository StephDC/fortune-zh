#!/bin/sh
# fortune-zh
#   invokes fortune with Chinese cookies.

set -e

FORTUNE="/usr/games/fortune"

# the old version of fortune-zh only show tang300 and song100
DICT="50% tang300 15% song100 35% chinese"
DICT_OLD="75% tang300 25% song100"
DICT_NEW="chinese"
# default settings
USE_DICT=${DICT}

# check LANG
if [ ! -z $LC_ALL ]; then 
	LANG="$LC_ALL"
fi

# check arg
if [ ! -z $1 ]; then
	case "$1" in
	"old")
		USE_DICT=${DICT_OLD}
		;;
	"new")
		USE_DICT=${DICT_NEW}
		;;
	*)
		;;
	esac
fi

# output according to LANG
case "$LANG" in
"zh_CN.GB2312")
	LANG=zh_CN.UTF8 $FORTUNE $USE_DICT | iconv -c -f utf8 -t gbk
	;;
"zh_TW.Big5")
	LANG=zh_TW.UTF8 $FORTUNE $USE_DICT | iconv -c -f utf8 -t big5
	;;
*)
	$FORTUNE $USE_DICT 
	;;
esac

#EOF
